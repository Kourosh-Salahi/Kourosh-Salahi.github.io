<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CS180 Project 2 — Filters, Hybrid Images, and Multi-Resolution Blending</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0b1020;
      --card: #111836;
      --muted: #a0aec0;
      --ink: #e6eefc;
      --accent: #8ab4ff;
    }
    body { margin:0; font-family:Inter,system-ui,sans-serif; background:var(--bg); color:var(--ink); line-height:1.6; }
    .container { max-width:1100px; margin:0 auto; padding:20px; }

    header { padding:32px 20px; background:linear-gradient(to bottom,rgba(11,16,32,0.95),rgba(11,16,32,0.7)); border-bottom:1px solid rgba(255,255,255,0.08);}
    .brand { display:flex; align-items:center; gap:12px; }
    .brand .dot { width:10px; height:10px; border-radius:50%; background:var(--accent); }
    .brand h1 { font-size:18px; margin:0; font-weight:800; }
    nav { margin-left:auto; font-size:14px; display:flex; gap:12px; }
    nav a { color:var(--accent); text-decoration:none; }
    nav a:hover { text-decoration:underline; }

    .card { background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.08); border-radius:18px; padding:20px; margin-bottom:30px; }
    h2 { margin-top:0; }

    .hero-title { font-size:clamp(28px,4vw,44px); font-weight:800; margin:0 0 10px; }
    .subtitle { color:var(--muted); margin:0 0 10px; }
    .meta { display:flex; flex-wrap:wrap; gap:12px; margin-top:10px; font-size:14px; }
    .pill { padding:6px 10px; border-radius:999px; background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.08); }

    .grid { display:grid; gap:16px; }
    .grid.two { grid-template-columns:repeat(2,1fr); }
    .grid.three { grid-template-columns:repeat(3,1fr); }
    .grid.four { grid-template-columns:repeat(4,1fr); }
    .grid.five { grid-template-columns:repeat(5,1fr); }
    figure { margin:0; cursor:zoom-in; }

    img { width:100%; max-height:250px; object-fit:contain; border-radius:12px; border:1px solid rgba(255,255,255,0.08); }
    img[src*="expanded.jpg"], img[src*="stack"], img[src*="dreekend_process"], img[src*="fig234"] { max-height:none; width:100%; }

    figcaption { font-size:14px; color:var(--muted); }
    pre { background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.08); padding:14px; border-radius:12px; overflow:auto; font-size:14px; }

    .lightbox { display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(7,10,22,0.9); z-index:1000; justify-content:center; align-items:center; padding:40px; }
    .lightbox img { max-width:90%; max-height:90%; border-radius:18px; box-shadow:0 20px 60px rgba(0,0,0,0.6); cursor:zoom-out; }
  </style>
</head>
<body>
  <header>
    <div class="container brand">
      <span class="dot"></span>
      <h1>CS180 · Project 2</h1>
      <nav>
        <a href="#part1">Part 1</a>
        <a href="#part2">Part 2</a>
        <a href="#hybrids">Hybrids</a>
        <a href="#blending">Blending</a>
      </nav>
    </div>
  </header>

  <main class="container">

    <!-- Hero -->
    <section class="card">
      <h2 class="hero-title">Filters, Hybrid Images, and Multi-Resolution Blending</h2>
      <p class="subtitle">By <strong>Kourosh Salahi</strong> · CS180: Computer Vision & Computational Photography</p>
    </section>

    <!-- Part 1.1 -->
    <section class="card" id="part1">
      <h2>Part 1.1 — Convolution</h2>
      <p>This section implements convolution from scratch with both four nested loops and a more efficient two-loop version. Results are compared to <code>scipy.signal.convolve2d</code> in terms of runtime and edge handling.</p>
      <pre><code>def conv4loops(image, kernel):
    height, width = image.shape
    kh, kw = kernel.shape
    pad_h, pad_w = kh // 2, kw // 2
    padded = np.pad(image, ((pad_h, pad_h), (pad_w, pad_w)), mode="constant")
    output = np.zeros_like(image)
    for i in range(height):
        for j in range(width):
            val = 0
            for m in range(kh):
                for n in range(kw):
                    val += kernel[m, n] * padded[i+m, j+n]
            output[i, j] = val
    return output
</code></pre>
      <pre><code>def conv2loops(image, kernel):
    height, width = image.shape
    kh, kw = kernel.shape
    pad_h, pad_w = kh // 2, kw // 2
    padded = np.pad(image, ((pad_h, pad_h), (pad_w, pad_w)), mode="constant")
    output = np.zeros_like(image)
    for i in range(height):
            for j in range(width):
                region = padded[i:i+kh, j:j+kw]
                output[i, j] = np.sum(region * kernel)
    return output</code></pre>
      <div class="grid four">
        <figure><img src="./media/Me.jpg" onclick="openLightbox(this.src)"><figcaption>Original image (grayscale self-portrait)</figcaption></figure>
        <figure><img src="./media/res_four.png" onclick="openLightbox(this.src)"><figcaption>9×9 box filter result</figcaption></figure>
        <figure><img src="./media/fdx_two.png" onclick="openLightbox(this.src)"><figcaption>Finite difference Dx</figcaption></figure>
        <figure><img src="./media/fdy_two.png" onclick="openLightbox(this.src)"><figcaption>Finite difference Dy</figcaption></figure>
      </div>
      <p><em>Runtime: the four loop convolution was much slower, taking 1 minute and 4 seconds to run, compared to the 2 loop convolution only taking 10 seconds. These were both much slower than the built in method, convolve2d, which took 0.3 seconds</em></p>
        <p><em>Boundaries: boundaries are handled with zero padding in my implementation, and optinal, changeable padding in the scipy version.</em></p>
    </section>

    <!-- Part 1.2 -->
    <section class="card">
      <h2>Part 1.2 — Derivatives & Edges</h2>
      <p>Finite difference filters are applied to the Cameraman image to extract partial derivatives. I found that the best threshold was 0.32. When I went to high above this, I would lose out on the thickness of the edges. 
        When i went below this, I would get more noise. The value 0.32 allowed me to get most of the cameraman's edges while only getting a little bit of the background included</p>
      <div class="grid five">
        <figure><img src="./media/cameraman.png" onclick="openLightbox(this.src)"><figcaption>Original Cameraman</figcaption></figure>
        <figure><img src="./media/cameraman_gx.png" onclick="openLightbox(this.src)"><figcaption>Partial derivative Dx</figcaption></figure>
        <figure><img src="./media/cameraman_gy.png" onclick="openLightbox(this.src)"><figcaption>Partial derivative Dy</figcaption></figure>
        <figure><img src="./media/cameraman_gradmag.png" onclick="openLightbox(this.src)"><figcaption>Gradient magnitude</figcaption></figure>
        <figure><img src="./media/cameraman_edges.png" onclick="openLightbox(this.src)"><figcaption>Binarized edge map</figcaption></figure>
      </div>
    </section>

    <!-- Part 1.3 -->
    <section class="card">
      <h2>Part 1.3 — Gaussian & DoG</h2>
      <p>Gaussian smoothing reduces noise before edge detection. Derivative of Gaussian (DoG) filters combine smoothing and differentiation into one operation, producing cleaner results compared to plain finite difference.</p>
      <div class="grid four">
        <figure><img src="./media/DoGx.png" onclick="openLightbox(this.src)"><figcaption>DoG filter (x-direction)</figcaption></figure>
        <figure><img src="./media/DoGy.png" onclick="openLightbox(this.src)"><figcaption>DoG filter (y-direction)</figcaption></figure>
        <figure><img src="./media/cam_gradmag_blur.png" onclick="openLightbox(this.src)"><figcaption>Edges via blur first</figcaption></figure>
        <figure><img src="./media/cam_gradmag_dog.png" onclick="openLightbox(this.src)"><figcaption>Edges via DoG</figcaption></figure>
      </div>
      <p><em>Observation: DoG/blurred edges are thicker and less noisy compared to plain finite difference.</em></p>
      <p><em>Verification: Both Edge images are the same as found by computing their difference in the code and finding that it is negligible.</em></p>
    </section>

    <!-- Part 2.1 -->
    <section class="card" id="part2">
      <h2>Part 2.1 — Unsharp Mask</h2>
      <p>Unsharp masking subtracts a blurred image (low frequencies) from the original to extract high frequencies, which are then added back to sharpen the result.</p>
      <div class="grid four">
        <figure><img src="./media/taj.jpg" onclick="openLightbox(this.src)"><figcaption>Original Taj Mahal</figcaption></figure>
        <figure><img src="./media/blurred_taj.jpg" onclick="openLightbox(this.src)"><figcaption>Blurred Taj</figcaption></figure>
        <figure><img src="./media/high_taj.jpg" onclick="openLightbox(this.src)"><figcaption>High frequencies</figcaption></figure>
        <figure><img src="./media/sharp_taj.jpg" onclick="openLightbox(this.src)"><figcaption>Sharpened Taj</figcaption></figure>
      </div>
      <div class="grid four">
        <figure><img src="./media/taj.jpg" onclick="openLightbox(this.src)"><figcaption>Original Taj Mahal</figcaption></figure>
        <figure><img src="./media/blurred_taj_stronger.jpg" onclick="openLightbox(this.src)"><figcaption>Blurred Taj with more sharpening</figcaption></figure>
        <figure><img src="./media/high_taj_stronger.jpg" onclick="openLightbox(this.src)"><figcaption>High frequencies with more sharpening</figcaption></figure>
        <figure><img src="./media/sharp_taj_stronger.jpg" onclick="openLightbox(this.src)"><figcaption>Sharpened Taj with more sharpening</figcaption></figure>
      </div>
      <div class="grid four">
        <figure><img src="./media/dog.jpg" onclick="openLightbox(this.src)"><figcaption>Original Dog</figcaption></figure>
        <figure><img src="./media/blurred_dog.jpg" onclick="openLightbox(this.src)"><figcaption>Blurred Dog</figcaption></figure>
        <figure><img src="./media/high_dog.jpg" onclick="openLightbox(this.src)"><figcaption>High frequencies</figcaption></figure>
        <figure><img src="./media/sharp_dog.jpg" onclick="openLightbox(this.src)"><figcaption>Sharpened Dog</figcaption></figure>
      </div>
      <div class="grid four">
        <figure><img src="./media/pre_sharp_cat.jpeg" onclick="openLightbox(this.src)"><figcaption>Original Cat</figcaption></figure>
        <figure><img src="./media/blurred_cat.jpeg" onclick="openLightbox(this.src)"><figcaption>Blurred Cat</figcaption></figure>
        <figure><img src="./media/high_blurred_catresharpened.jpeg" onclick="openLightbox(this.src)"><figcaption>High frequencies</figcaption></figure>
        <figure><img src="./media/sharp_blurred_catresharpened.jpeg" onclick="openLightbox(this.src)"><figcaption>Resharpened Cat</figcaption></figure>
      </div>
      <p><em>Observation: Sharpening improves details but can amplify noise if over-applied. Also makes the images more vibrant</em></p>
      <p><em>Key Point to notice: more sharpening on the taj mahal not only makes the image sharper, but also more vibrant/saturated</em></p>
    </section>

    <!-- Part 2.2 -->
    <section class="card" id="hybrids">
      <h2>Part 2.2 — Hybrid Images</h2>
      <p>Hybrid images mix low frequencies from one source and high frequencies from another. The perception changes depending on viewing distance. To see the effect best: click on the hybrid image of your choice, then look at it from very close, and then look at it from very far. You should see two different images.</p>
      <div class="grid three">
        <figure><img src="./media/DerekPicture.jpg" onclick="openLightbox(this.src)"><figcaption>Derek </figcaption></figure>
        <figure><img src="./media/nutmeg.jpg" onclick="openLightbox(this.src)"><figcaption>Nutmeg</figcaption></figure>
        <figure><img src="./media/hybrid_Derek.jpg" onclick="openLightbox(this.src)"><figcaption>Derek + Nutmeg. Dutmeg, if you will.</figcaption></figure>
      </div>
      <div class="grid three">
        <figure><img src="./media/Bron.jpg" onclick="openLightbox(this.src)"><figcaption>LeBron</figcaption></figure>
        <figure><img src="./media/Denero.jpg" onclick="openLightbox(this.src)"><figcaption>Denero</figcaption></figure>
        <figure><img src="./media/hybrid_DeneroBron.jpg" onclick="openLightbox(this.src)"><figcaption>LeBron + Denero. Respective G.O.A.T.s</figcaption></figure>
      </div>
      <div class="grid three">
        <figure><img src="./media/gihun_happy.webp" onclick="openLightbox(this.src)"><figcaption>Gi-hun Happy</figcaption></figure>
        <figure><img src="./media/gihun_mad.webp" onclick="openLightbox(this.src)"><figcaption>Gi-hun Mad</figcaption></figure>
        <figure><img src="./media/hybrid_Gihun.jpg" onclick="openLightbox(this.src)"><figcaption>Gi-hun Expressions</figcaption></figure>
      </div>
      <div class="grid three">
        <figure><img src="./media/Monkey.jpg" onclick="openLightbox(this.src)"><figcaption>Monkey Image 1</figcaption></figure>
        <figure><img src="./media/monkey2.jpg" onclick="openLightbox(this.src)"><figcaption>Monkey Image 2</figcaption></figure>
        <figure><img src="./media/hybrid_Monkey.jpg" onclick="openLightbox(this.src)"><figcaption>Monkey Blend</figcaption></figure>
      </div>
      <div>
        <figure><img src="./media/expanded.jpg" onclick="openLightbox(this.src)"><figcaption>Fourier Analysis of Hybrid Monkey</figcaption></figure>
      </div>
      <p><em>Observation: At close distance, high-frequency details dominate. At far distance, low-frequency structures dominate.</em></p>
    </section>

    <!-- Part 2.3 -->
    <section class="card" id="blending">
      <h2>Part 2.3 — Multi-resolution Blending</h2>
      <p>Gaussian and Laplacian stacks allow smooth blending, avoiding harsh seams. Here I recreate the classic “Oraple” and experiment with custom blends.</p>

      <div class="grid three">
        <figure><img src="./media/apple.jpeg" onclick="openLightbox(this.src)"><figcaption>Apple source</figcaption></figure>
        <figure><img src="./media/orange.jpeg" onclick="openLightbox(this.src)"><figcaption>Orange source</figcaption></figure>
        <figure><img src="./media/oraple.png" onclick="openLightbox(this.src)"><figcaption>Oraple</figcaption></figure>
      </div>

      <div class="grid three">
        <figure><img src="./media/apple_stack.png" onclick="openLightbox(this.src)"><figcaption>Apple stack</figcaption></figure>
        <figure><img src="./media/orange_stack.png" onclick="openLightbox(this.src)"><figcaption>Orange stack</figcaption></figure>
        <figure><img src="./media/fig234.png" onclick="openLightbox(this.src)"><figcaption>Reference Fig. 3.42</figcaption></figure>
      </div>

      <div class="grid three">
        <figure><img src="./media/golf_img.jpg" onclick="openLightbox(this.src)"><figcaption>Golf image</figcaption></figure>
        <figure><img src="./media/face.jpg" onclick="openLightbox(this.src)"><figcaption>Face image</figcaption></figure>
        <figure><img src="./media/golface.png" onclick="openLightbox(this.src)"><figcaption>Golf + Face blend. Golface</figcaption></figure>
      </div>

      <div class="grid three">
        <figure><img src="./media/weeknd.jpg" onclick="openLightbox(this.src)"><figcaption>Weeknd source</figcaption></figure>
        <figure><img src="./media/drake2.jpg" onclick="openLightbox(this.src)"><figcaption>Drake source</figcaption></figure>
        <figure><img src="./media/dreekend.png" onclick="openLightbox(this.src)"><figcaption>The Dreekend</figcaption></figure>
      </div>

      <div>
        <figure><img src="./media/dreekend_process.png" onclick="openLightbox(this.src)"><figcaption>Laplacian stack visualization for “Dreekend”</figcaption></figure>
      </div>

      <p><em>Observation: The golface image has a circular mask. Notice that it is more than just transparency on the face and pasting that over the golf ball, the ball blends into the face, and you can see parts of the golf ball divots fade away as the face becomes more prominent. The face is rather light, which was my attempt to match the shades. 
      I would assume that implementing color matching would make the blend much prettier.</em></p>
      <p><em>Observation: The Weeknd and Drake both make music that is enjoyable together. Their faces are not enjoyable together. The way that their mouths, hairlines, noses, and forehead wrinkles line up make the image rather eery. Notice that the sharp line above drake is not a seam, but a remant of the background he stands in front of.</em></p>
    </section>

  </main>

  <div id="lightbox" class="lightbox" onclick="closeLightbox()">
    <img id="lightbox-img" src="" alt="">
  </div>

  <script>
    function openLightbox(src) {
      document.getElementById('lightbox-img').src = src;
      document.getElementById('lightbox').style.display = 'flex';
    }
    function closeLightbox() {
      document.getElementById('lightbox').style.display = 'none';
    }
  </script>
</body>
</html>
